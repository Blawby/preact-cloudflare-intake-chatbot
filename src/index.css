@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    color-scheme: light dark;
  }

  body {
    @apply min-h-screen m-0;
  }

  /* Global link styles */
  a {
    @apply text-accent-500 hover:text-accent-600 transition-colors duration-200;
  }

  /* Dark mode link styles */
  .dark a {
    @apply text-accent-400 hover:text-accent-300;
  }

  /* Utility classes for specific link styles */
  .link-plain {
    @apply no-underline font-normal;
  }

  .link-btn {
    @apply no-underline font-bold;
  }

  /* Hide scrollbars when modal is open */
  body.modal-open .overflow-y-auto,
  body.modal-open .overflow-auto {
    scrollbar-width: none;
    /* Firefox */
    -ms-overflow-style: none;
    /* Internet Explorer 10+ */
  }

  body.modal-open .overflow-y-auto::-webkit-scrollbar,
  body.modal-open .overflow-auto::-webkit-scrollbar {
    display: none;
    /* Safari and Chrome */
  }

  /* Mobile viewport handling */
  @media (max-width: 768px) {
    .h-screen {
      height: 100vh;
      /* Fallback */
      height: 100dvh;
      /* Dynamic viewport height for mobile */
    }

    /* Safe area handling for mobile devices with notches */
    .pt-16 {
      padding-top: 4rem;
      /* Fallback */
      padding-top: max(4rem, env(safe-area-inset-top, 0px));
    }

    .pt-safe {
      padding-top: env(safe-area-inset-top, 0px);
    }
  }
}

@layer components {
  .chat-markdown {
    @apply text-base leading-relaxed text-gray-900 dark:text-gray-100 whitespace-pre-wrap break-words;
  }

  .chat-markdown p {
    @apply mt-0 mb-3;
  }

  .chat-markdown p:last-child {
    @apply mb-0;
  }

  .chat-markdown strong {
    @apply font-semibold;
  }

  .chat-markdown em {
    @apply italic;
  }

  .chat-markdown a {
    @apply underline text-accent-500 hover:text-accent-600 transition-colors duration-200;
  }

  .dark .chat-markdown a {
    @apply text-accent-300 hover:text-accent-200;
  }

  /* File display styling */
  .file-display {
    @apply flex items-center gap-2 p-2 rounded-2xl;
    @apply bg-light-file-bg dark:bg-dark-file-bg;
    @apply border border-light-file-border dark:border-dark-file-border;
    @apply transition-all duration-200;
  }

  .file-display-icon {
    @apply flex-shrink-0;
  }

  .file-display-info {
    @apply flex-1 min-w-0;
  }

  .file-display-name {
    @apply text-sm font-medium text-light-file-text dark:text-dark-file-text truncate;
  }

  .file-display-type {
    @apply text-xs text-light-file-text-secondary dark:text-dark-file-text-secondary;
  }

  .file-display-remove {
    @apply flex-shrink-0 w-6 h-6 rounded-full;
    @apply flex items-center justify-center;
    @apply bg-light-file-remove-bg dark:bg-dark-file-remove-bg;
    @apply hover:bg-light-file-remove-hover dark:hover:bg-dark-file-remove-hover;
    @apply transition-colors;
  }

  .file-display-remove-icon {
    @apply w-3.5 h-3.5 text-white;
  }

  /* Message composer styling */
  .message-composer-container {
    @apply flex flex-col w-full relative;
    @apply bg-gray-200 dark:bg-gray-900;
    @apply border border-gray-300 dark:border-gray-700;
    @apply rounded-2xl p-2 min-h-[48px] gap-2 h-auto overflow-visible;
  }

  .message-composer-preview-container {
    @apply flex gap-2 overflow-x-auto scrollbar-hide;
  }

  .message-composer-input-row {
    @apply flex items-center gap-3 w-full;
  }

  /* Standardized input styling */
  .input-base {
    @apply w-full px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-dark-input-bg text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-accent-500 focus:border-accent-500 transition-colors;
  }

  .input-base.error {
    @apply border-red-500 focus:ring-red-500 focus:border-red-500;
  }

  .input-with-icon {
    @apply pl-10;
  }

  .chat-markdown ul,
  .chat-markdown ol {
    @apply ml-5 mb-3;
  }

  .chat-markdown ul {
    @apply list-disc;
  }

  .chat-markdown ol {
    @apply list-decimal;
  }

  .chat-markdown li {
    @apply mb-1;
  }

  .chat-markdown li:last-child {
    @apply mb-0;
  }

  .chat-markdown blockquote {
    @apply pl-4 border-l-4 border-gray-200 dark:border-gray-700 text-gray-700 dark:text-gray-300 italic mb-3;
  }

  .chat-markdown code {
    @apply px-1 py-0.5 rounded bg-gray-100 dark:bg-gray-800 text-sm font-mono;
  }

  .chat-markdown pre {
    @apply bg-gray-900/90 text-gray-100 rounded-md p-4 overflow-x-auto text-sm leading-relaxed mb-4;
  }

  .chat-markdown pre code {
    @apply bg-transparent p-0 text-inherit;
  }

  .chat-markdown hr {
    @apply border-gray-200 dark:border-gray-700 my-6;
  }

  .chat-markdown .chat-cursor {
    @apply inline-block align-middle ml-2 h-2.5 w-2.5 rounded-full bg-accent-500/80 animate-pulse;
  }
}

@layer utilities {

  /* Simple accordion styles */
  [data-state="open"] [data-slot="accordion-trigger"] svg {
    transform: rotate(180deg);
  }

  [data-state="closed"] [data-slot="accordion-content"] {
    display: none;
  }

  [data-state="open"] [data-slot="accordion-content"] {
    display: block;
  }

  /* Hide scrollbar */
  .scrollbar-hide {
    -ms-overflow-style: none;
    /* Internet Explorer 10+ */
    scrollbar-width: none;
    /* Firefox */
  }

  .scrollbar-hide::-webkit-scrollbar {
    display: none;
    /* Safari and Chrome */
  }

  /* RTL (Right-to-Left) Support */
  /* Automatically flip margins and paddings for RTL languages */
  [dir="rtl"] .ml-auto {
    margin-left: unset;
    margin-right: auto;
  }

  [dir="rtl"] .mr-auto {
    margin-right: unset;
    margin-left: auto;
  }

  [dir="rtl"] .text-left {
    text-align: right;
  }

  [dir="rtl"] .text-right {
    text-align: left;
  }

  /* Flip list markers in RTL */
  [dir="rtl"] .chat-markdown ul,
  [dir="rtl"] .chat-markdown ol {
    margin-left: 0;
    margin-right: 1.25rem;
  }

  /* Flip border-left to border-right for blockquotes in RTL */
  [dir="rtl"] .chat-markdown blockquote {
    padding-left: 0;
    padding-right: 1rem;
    border-left: none;
    border-right: 4px solid;
    @apply border-gray-200 dark:border-gray-700;
  }

  /* Flip cursor animation position in RTL */
  [dir="rtl"] .chat-markdown .chat-cursor {
    margin-left: 0;
    margin-right: 0.5rem;
  }

  /* Flip icon positions in inputs for RTL */
  [dir="rtl"] .input-with-icon {
    padding-left: 0.75rem;
    padding-right: 2.5rem;
  }
}
